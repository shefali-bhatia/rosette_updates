#lang rosette 
 
(require "../cosette.rkt" "../util.rkt" "../denotation.rkt" "../cosette.rkt" "../sql.rkt" "../evaluator.rkt" "../syntax.rkt" "../symmetry.rkt" "../test-util.rkt") 
  

(provide ros-instance)  

(current-bitwidth #f)

(define t0 (table-info "input" (list "Employee" "FromDate" "ToDate" "Code")))
 
(define (q5 tables) 
(SELECT (VALS "t4.Employee" "t4.min_FromDate" "t4.max_ToDate" "t4.Code1" )
 FROM (AS (JOIN (AS (SELECT (VALS "t2.Employee" "t2.Code" (VAL-UNOP aggr-max (val-column-ref "t2.ToDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t2" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t2.Employee" "t2.Code" )
 HAVING (TRUE)) ["t1" (list "Employee" "Code" "max_ToDate")]) (AS (SELECT (VALS "t3.Code" (VAL-UNOP aggr-min (val-column-ref "t3.FromDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t3" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t3.Code" )
 HAVING (TRUE)) ["t5" (list "Code" "min_FromDate")])) ["t4" (list "Employee" "Code" "max_ToDate" "Code1" "min_FromDate")])
 WHERE (AND (BINOP "t4.Code" = "t4.Code1") (TRUE))))
 
(define (q4 tables) 
(SELECT (VALS "t3.Employee1" "t3.min_FromDate" "t3.max_ToDate" "t3.Code1" )
 FROM (AS (JOIN (AS (SELECT (VALS "t2.Employee" "t2.Code" (VAL-UNOP aggr-max (val-column-ref "t2.ToDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t2" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t2.Employee" "t2.Code" )
 HAVING (TRUE)) ["t1" (list "Employee" "Code" "max_ToDate")]) (AS (SELECT (VALS "t5.Employee" "t5.Code" (VAL-UNOP aggr-min (val-column-ref "t5.FromDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t5" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t5.Employee" "t5.Code" )
 HAVING (TRUE)) ["t4" (list "Employee" "Code" "min_FromDate")])) ["t3" (list "Employee" "Code" "max_ToDate" "Employee1" "Code1" "min_FromDate")])
 WHERE (AND (BINOP "t3.Code" = "t3.Code1") (TRUE))))
 
(define (q3 tables) 
(SELECT (VALS "t5.Employee" "t5.min_FromDate" "t5.max_ToDate" "t5.Code1" )
 FROM (AS (JOIN (AS (SELECT (VALS "t2.Code" (VAL-UNOP aggr-min (val-column-ref "t2.FromDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t2" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t2.Code" )
 HAVING (TRUE)) ["t3" (list "Code" "min_FromDate")]) (AS (SELECT (VALS "t1.Employee" "t1.Code" (VAL-UNOP aggr-max (val-column-ref "t1.ToDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t1" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t1.Employee" "t1.Code" )
 HAVING (TRUE)) ["t4" (list "Employee" "Code" "max_ToDate")])) ["t5" (list "Code" "min_FromDate" "Employee" "Code1" "max_ToDate")])
 WHERE (AND (BINOP "t5.Code" = "t5.Code1") (TRUE))))
 
(define (q2 tables) 
(SELECT (VALS "t3.Employee" "t3.min_FromDate" "t3.max_ToDate" "t3.Code1" )
 FROM (AS (JOIN (AS (SELECT (VALS "t5.Employee" "t5.Code" (VAL-UNOP aggr-min (val-column-ref "t5.FromDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t5" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t5.Employee" "t5.Code" )
 HAVING (TRUE)) ["t4" (list "Employee" "Code" "min_FromDate")]) (AS (SELECT (VALS "t1.Code" (VAL-UNOP aggr-max (val-column-ref "t1.ToDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t1" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t1.Code" )
 HAVING (TRUE)) ["t2" (list "Code" "max_ToDate")])) ["t3" (list "Employee" "Code" "min_FromDate" "Code1" "max_ToDate")])
 WHERE (AND (BINOP "t3.Code" = "t3.Code1") (TRUE))))
 
(define (q1 tables) 
(SELECT (VALS "t4.Employee1" "t4.min_FromDate" "t4.max_ToDate" "t4.Code1" )
 FROM (AS (JOIN (AS (SELECT (VALS "t2.Employee" "t2.Code" (VAL-UNOP aggr-min (val-column-ref "t2.FromDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t2" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t2.Employee" "t2.Code" )
 HAVING (TRUE)) ["t3" (list "Employee" "Code" "min_FromDate")]) (AS (SELECT (VALS "t1.Employee" "t1.Code" (VAL-UNOP aggr-max (val-column-ref "t1.ToDate")) )
 FROM (AS (NAMED (list-ref tables 0)) ["t1" (list "Employee" "FromDate" "ToDate" "Code")])
 WHERE (TRUE)
 GROUP-BY (list "t1.Employee" "t1.Code" )
 HAVING (TRUE)) ["t5" (list "Employee" "Code" "max_ToDate")])) ["t4" (list "Employee" "Code" "min_FromDate" "Employee1" "Code1" "max_ToDate")])
 WHERE (AND (BINOP "t4.Code" = "t4.Code1") (TRUE))))

(define ros-instance (list q1 q2 (list t0)))
